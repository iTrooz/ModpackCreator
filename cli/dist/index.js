#!/usr/bin/env bun
// @bun
import{createRequire as Q0}from"node:module";var e=Object.create;var{getPrototypeOf:$0,defineProperty:O,getOwnPropertyNames:z0}=Object;var G0=Object.prototype.hasOwnProperty;var J0=($,z,G)=>{G=$!=null?e($0($)):{};let J=z||!$||!$.__esModule?O(G,"default",{value:$,enumerable:!0}):G;for(let Q of z0($))if(!G0.call(J,Q))O(J,Q,{get:()=>$[Q],enumerable:!0});return J};var S=($,z)=>()=>(z||$((z={exports:{}}).exports,z),z.exports);var R=Q0(import.meta.url);var j=S((X0)=>{class V extends Error{constructor($,z,G){super(G);Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.code=z,this.exitCode=$,this.nestedError=void 0}}class x extends V{constructor($){super(1,"commander.invalidArgument",$);Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name}}X0.CommanderError=V;X0.InvalidArgumentError=x});var N=S((B0)=>{var{InvalidArgumentError:_0}=j();class f{constructor($,z){switch(this.description=z||"",this.variadic=!1,this.parseArg=void 0,this.defaultValue=void 0,this.defaultValueDescription=void 0,this.argChoices=void 0,$[0]){case"<":this.required=!0,this._name=$.slice(1,-1);break;case"[":this.required=!1,this._name=$.slice(1,-1);break;default:this.required=!0,this._name=$;break}if(this._name.length>3&&this._name.slice(-3)==="...")this.variadic=!0,this._name=this._name.slice(0,-3)}name(){return this._name}_concatValue($,z){if(z===this.defaultValue||!Array.isArray(z))return[$];return z.concat($)}default($,z){return this.defaultValue=$,this.defaultValueDescription=z,this}argParser($){return this.parseArg=$,this}choices($){return this.argChoices=$.slice(),this.parseArg=(z,G)=>{if(!this.argChoices.includes(z))throw new _0(`Allowed choices are ${this.argChoices.join(", ")}.`);if(this.variadic)return this._concatValue(z,G);return z},this}argRequired(){return this.required=!0,this}argOptional(){return this.required=!1,this}}function q0($){let z=$.name()+($.variadic===!0?"...":"");return $.required?"<"+z+">":"["+z+"]"}B0.Argument=f;B0.humanReadableArgName=q0});var M=S((L0)=>{var{humanReadableArgName:T0}=N();class v{constructor(){this.helpWidth=void 0,this.sortSubcommands=!1,this.sortOptions=!1,this.showGlobalOptions=!1}visibleCommands($){let z=$.commands.filter((G)=>!G._hidden);if($._hasImplicitHelpCommand()){let[,G,J]=$._helpCommandnameAndArgs.match(/([^ ]+) *(.*)/),Q=$.createCommand(G).helpOption(!1);if(Q.description($._helpCommandDescription),J)Q.arguments(J);z.push(Q)}if(this.sortSubcommands)z.sort((G,J)=>{return G.name().localeCompare(J.name())});return z}compareOptions($,z){let G=(J)=>{return J.short?J.short.replace(/^-/,""):J.long.replace(/^--/,"")};return G($).localeCompare(G(z))}visibleOptions($){let z=$.options.filter((Q)=>!Q.hidden),G=$._hasHelpOption&&$._helpShortFlag&&!$._findOption($._helpShortFlag),J=$._hasHelpOption&&!$._findOption($._helpLongFlag);if(G||J){let Q;if(!G)Q=$.createOption($._helpLongFlag,$._helpDescription);else if(!J)Q=$.createOption($._helpShortFlag,$._helpDescription);else Q=$.createOption($._helpFlags,$._helpDescription);z.push(Q)}if(this.sortOptions)z.sort(this.compareOptions);return z}visibleGlobalOptions($){if(!this.showGlobalOptions)return[];let z=[];for(let G=$.parent;G;G=G.parent){let J=G.options.filter((Q)=>!Q.hidden);z.push(...J)}if(this.sortOptions)z.sort(this.compareOptions);return z}visibleArguments($){if($._argsDescription)$._args.forEach((z)=>{z.description=z.description||$._argsDescription[z.name()]||""});if($._args.find((z)=>z.description))return $._args;return[]}subcommandTerm($){let z=$._args.map((G)=>T0(G)).join(" ");return $._name+($._aliases[0]?"|"+$._aliases[0]:"")+($.options.length?" [options]":"")+(z?" "+z:"")}optionTerm($){return $.flags}argumentTerm($){return $.name()}longestSubcommandTermLength($,z){return z.visibleCommands($).reduce((G,J)=>{return Math.max(G,z.subcommandTerm(J).length)},0)}longestOptionTermLength($,z){return z.visibleOptions($).reduce((G,J)=>{return Math.max(G,z.optionTerm(J).length)},0)}longestGlobalOptionTermLength($,z){return z.visibleGlobalOptions($).reduce((G,J)=>{return Math.max(G,z.optionTerm(J).length)},0)}longestArgumentTermLength($,z){return z.visibleArguments($).reduce((G,J)=>{return Math.max(G,z.argumentTerm(J).length)},0)}commandUsage($){let z=$._name;if($._aliases[0])z=z+"|"+$._aliases[0];let G="";for(let J=$.parent;J;J=J.parent)G=J.name()+" "+G;return G+z+" "+$.usage()}commandDescription($){return $.description()}subcommandDescription($){return $.summary()||$.description()}optionDescription($){let z=[];if($.argChoices)z.push(`choices: ${$.argChoices.map((G)=>JSON.stringify(G)).join(", ")}`);if($.defaultValue!==void 0){if($.required||$.optional||$.isBoolean()&&typeof $.defaultValue==="boolean")z.push(`default: ${$.defaultValueDescription||JSON.stringify($.defaultValue)}`)}if($.presetArg!==void 0&&$.optional)z.push(`preset: ${JSON.stringify($.presetArg)}`);if($.envVar!==void 0)z.push(`env: ${$.envVar}`);if(z.length>0)return`${$.description} (${z.join(", ")})`;return $.description}argumentDescription($){let z=[];if($.argChoices)z.push(`choices: ${$.argChoices.map((G)=>JSON.stringify(G)).join(", ")}`);if($.defaultValue!==void 0)z.push(`default: ${$.defaultValueDescription||JSON.stringify($.defaultValue)}`);if(z.length>0){let G=`(${z.join(", ")})`;if($.description)return`${$.description} ${G}`;return G}return $.description}formatHelp($,z){let G=z.padWidth($,z),J=z.helpWidth||80,Q=2,X=2;function Z(W,K){if(K){let F=`${W.padEnd(G+2)}${K}`;return z.wrap(F,J-2,G+2)}return W}function Y(W){return W.join(`
`).replace(/^/gm," ".repeat(2))}let _=[`Usage: ${z.commandUsage($)}`,""],q=z.commandDescription($);if(q.length>0)_=_.concat([z.wrap(q,J,0),""]);let B=z.visibleArguments($).map((W)=>{return Z(z.argumentTerm(W),z.argumentDescription(W))});if(B.length>0)_=_.concat(["Arguments:",Y(B),""]);let T=z.visibleOptions($).map((W)=>{return Z(z.optionTerm(W),z.optionDescription(W))});if(T.length>0)_=_.concat(["Options:",Y(T),""]);if(this.showGlobalOptions){let W=z.visibleGlobalOptions($).map((K)=>{return Z(z.optionTerm(K),z.optionDescription(K))});if(W.length>0)_=_.concat(["Global Options:",Y(W),""])}let P=z.visibleCommands($).map((W)=>{return Z(z.subcommandTerm(W),z.subcommandDescription(W))});if(P.length>0)_=_.concat(["Commands:",Y(P),""]);return _.join(`
`)}padWidth($,z){return Math.max(z.longestOptionTermLength($,z),z.longestGlobalOptionTermLength($,z),z.longestSubcommandTermLength($,z),z.longestArgumentTermLength($,z))}wrap($,z,G,J=40){let X=new RegExp(`[\\n][${" \\f\\t\\v   -   　\uFEFF"}]+`);if($.match(X))return $;let Z=z-G;if(Z<J)return $;let Y=$.slice(0,G),_=$.slice(G).replace(`\r
`,`
`),q=" ".repeat(G),T=`\\s${"​"}`,P=new RegExp(`
|.{1,${Z-1}}([${T}]|$)|[^${T}]+?([${T}]|$)`,"g"),W=_.match(P)||[];return Y+W.map((K,F)=>{if(K===`
`)return"";return(F>0?q:"")+K.trimEnd()}).join(`
`)}}L0.Help=v});var w=S((S0)=>{var{InvalidArgumentError:K0}=j();class h{constructor($,z){this.flags=$,this.description=z||"",this.required=$.includes("<"),this.optional=$.includes("["),this.variadic=/\w\.\.\.[>\]]$/.test($),this.mandatory=!1;let G=g($);if(this.short=G.shortFlag,this.long=G.longFlag,this.negate=!1,this.long)this.negate=this.long.startsWith("--no-");this.defaultValue=void 0,this.defaultValueDescription=void 0,this.presetArg=void 0,this.envVar=void 0,this.parseArg=void 0,this.hidden=!1,this.argChoices=void 0,this.conflictsWith=[],this.implied=void 0}default($,z){return this.defaultValue=$,this.defaultValueDescription=z,this}preset($){return this.presetArg=$,this}conflicts($){return this.conflictsWith=this.conflictsWith.concat($),this}implies($){let z=$;if(typeof $==="string")z={[$]:!0};return this.implied=Object.assign(this.implied||{},z),this}env($){return this.envVar=$,this}argParser($){return this.parseArg=$,this}makeOptionMandatory($=!0){return this.mandatory=!!$,this}hideHelp($=!0){return this.hidden=!!$,this}_concatValue($,z){if(z===this.defaultValue||!Array.isArray(z))return[$];return z.concat($)}choices($){return this.argChoices=$.slice(),this.parseArg=(z,G)=>{if(!this.argChoices.includes(z))throw new K0(`Allowed choices are ${this.argChoices.join(", ")}.`);if(this.variadic)return this._concatValue(z,G);return z},this}name(){if(this.long)return this.long.replace(/^--/,"");return this.short.replace(/^-/,"")}attributeName(){return P0(this.name().replace(/^no-/,""))}is($){return this.short===$||this.long===$}isBoolean(){return!this.required&&!this.optional&&!this.negate}}class u{constructor($){this.positiveOptions=new Map,this.negativeOptions=new Map,this.dualOptions=new Set,$.forEach((z)=>{if(z.negate)this.negativeOptions.set(z.attributeName(),z);else this.positiveOptions.set(z.attributeName(),z)}),this.negativeOptions.forEach((z,G)=>{if(this.positiveOptions.has(G))this.dualOptions.add(G)})}valueFromOption($,z){let G=z.attributeName();if(!this.dualOptions.has(G))return!0;let J=this.negativeOptions.get(G).presetArg,Q=J!==void 0?J:!1;return z.negate===(Q===$)}}function P0($){return $.split("-").reduce((z,G)=>{return z+G[0].toUpperCase()+G.slice(1)})}function g($){let z,G,J=$.split(/[ |,]+/);if(J.length>1&&!/^[[<]/.test(J[1]))z=J.shift();if(G=J.shift(),!z&&/^-[^-]$/.test(G))z=G,G=void 0;return{shortFlag:z,longFlag:G}}S0.Option=h;S0.splitOptionFlags=g;S0.DualOptions=u});var c=S((I0)=>{function N0($,z){if(Math.abs($.length-z.length)>3)return Math.max($.length,z.length);let G=[];for(let J=0;J<=$.length;J++)G[J]=[J];for(let J=0;J<=z.length;J++)G[0][J]=J;for(let J=1;J<=z.length;J++)for(let Q=1;Q<=$.length;Q++){let X=1;if($[Q-1]===z[J-1])X=0;else X=1;if(G[Q][J]=Math.min(G[Q-1][J]+1,G[Q][J-1]+1,G[Q-1][J-1]+X),Q>1&&J>1&&$[Q-1]===z[J-2]&&$[Q-2]===z[J-1])G[Q][J]=Math.min(G[Q][J],G[Q-2][J-2]+1)}return G[$.length][z.length]}function D0($,z){if(!z||z.length===0)return"";z=Array.from(new Set(z));let G=$.startsWith("--");if(G)$=$.slice(2),z=z.map((Z)=>Z.slice(2));let J=[],Q=3,X=0.4;if(z.forEach((Z)=>{if(Z.length<=1)return;let Y=N0($,Z),_=Math.max($.length,Z.length);if((_-Y)/_>X){if(Y<Q)Q=Y,J=[Z];else if(Y===Q)J.push(Z)}}),J.sort((Z,Y)=>Z.localeCompare(Y)),G)J=J.map((Z)=>`--${Z}`);if(J.length>1)return`
(Did you mean one of ${J.join(", ")}?)`;if(J.length===1)return`
(Did you mean ${J[0]}?)`;return""}I0.suggestSimilar=D0});var i=S((C0)=>{var V0=R("events").EventEmitter,A=R("child_process"),H=R("path"),y=R("fs"),U=R("process"),{Argument:M0,humanReadableArgName:w0}=N(),{CommanderError:k}=j(),{Help:A0}=M(),{Option:l,splitOptionFlags:y0,DualOptions:k0}=w(),{suggestSimilar:m}=c();class C extends V0{constructor($){super();this.commands=[],this.options=[],this.parent=null,this._allowUnknownOption=!1,this._allowExcessArguments=!0,this._args=[],this.args=[],this.rawArgs=[],this.processedArgs=[],this._scriptPath=null,this._name=$||"",this._optionValues={},this._optionValueSources={},this._storeOptionsAsProperties=!1,this._actionHandler=null,this._executableHandler=!1,this._executableFile=null,this._executableDir=null,this._defaultCommandName=null,this._exitCallback=null,this._aliases=[],this._combineFlagAndOptionalValue=!0,this._description="",this._summary="",this._argsDescription=void 0,this._enablePositionalOptions=!1,this._passThroughOptions=!1,this._lifeCycleHooks={},this._showHelpAfterError=!1,this._showSuggestionAfterError=!0,this._outputConfiguration={writeOut:(z)=>U.stdout.write(z),writeErr:(z)=>U.stderr.write(z),getOutHelpWidth:()=>U.stdout.isTTY?U.stdout.columns:void 0,getErrHelpWidth:()=>U.stderr.isTTY?U.stderr.columns:void 0,outputError:(z,G)=>G(z)},this._hidden=!1,this._hasHelpOption=!0,this._helpFlags="-h, --help",this._helpDescription="display help for command",this._helpShortFlag="-h",this._helpLongFlag="--help",this._addImplicitHelpCommand=void 0,this._helpCommandName="help",this._helpCommandnameAndArgs="help [command]",this._helpCommandDescription="display help for command",this._helpConfiguration={}}copyInheritedSettings($){return this._outputConfiguration=$._outputConfiguration,this._hasHelpOption=$._hasHelpOption,this._helpFlags=$._helpFlags,this._helpDescription=$._helpDescription,this._helpShortFlag=$._helpShortFlag,this._helpLongFlag=$._helpLongFlag,this._helpCommandName=$._helpCommandName,this._helpCommandnameAndArgs=$._helpCommandnameAndArgs,this._helpCommandDescription=$._helpCommandDescription,this._helpConfiguration=$._helpConfiguration,this._exitCallback=$._exitCallback,this._storeOptionsAsProperties=$._storeOptionsAsProperties,this._combineFlagAndOptionalValue=$._combineFlagAndOptionalValue,this._allowExcessArguments=$._allowExcessArguments,this._enablePositionalOptions=$._enablePositionalOptions,this._showHelpAfterError=$._showHelpAfterError,this._showSuggestionAfterError=$._showSuggestionAfterError,this}command($,z,G){let J=z,Q=G;if(typeof J==="object"&&J!==null)Q=J,J=null;Q=Q||{};let[,X,Z]=$.match(/([^ ]+) *(.*)/),Y=this.createCommand(X);if(J)Y.description(J),Y._executableHandler=!0;if(Q.isDefault)this._defaultCommandName=Y._name;if(Y._hidden=!!(Q.noHelp||Q.hidden),Y._executableFile=Q.executableFile||null,Z)Y.arguments(Z);if(this.commands.push(Y),Y.parent=this,Y.copyInheritedSettings(this),J)return this;return Y}createCommand($){return new C($)}createHelp(){return Object.assign(new A0,this.configureHelp())}configureHelp($){if($===void 0)return this._helpConfiguration;return this._helpConfiguration=$,this}configureOutput($){if($===void 0)return this._outputConfiguration;return Object.assign(this._outputConfiguration,$),this}showHelpAfterError($=!0){if(typeof $!=="string")$=!!$;return this._showHelpAfterError=$,this}showSuggestionAfterError($=!0){return this._showSuggestionAfterError=!!$,this}addCommand($,z){if(!$._name)throw new Error(`Command passed to .addCommand() must have a name
- specify the name in Command constructor or using .name()`);if(z=z||{},z.isDefault)this._defaultCommandName=$._name;if(z.noHelp||z.hidden)$._hidden=!0;return this.commands.push($),$.parent=this,this}createArgument($,z){return new M0($,z)}argument($,z,G,J){let Q=this.createArgument($,z);if(typeof G==="function")Q.default(J).argParser(G);else Q.default(G);return this.addArgument(Q),this}arguments($){return $.split(/ +/).forEach((z)=>{this.argument(z)}),this}addArgument($){let z=this._args.slice(-1)[0];if(z&&z.variadic)throw new Error(`only the last argument can be variadic '${z.name()}'`);if($.required&&$.defaultValue!==void 0&&$.parseArg===void 0)throw new Error(`a default value for a required argument is never used: '${$.name()}'`);return this._args.push($),this}addHelpCommand($,z){if($===!1)this._addImplicitHelpCommand=!1;else{if(this._addImplicitHelpCommand=!0,typeof $==="string")this._helpCommandName=$.split(" ")[0],this._helpCommandnameAndArgs=$;this._helpCommandDescription=z||this._helpCommandDescription}return this}_hasImplicitHelpCommand(){if(this._addImplicitHelpCommand===void 0)return this.commands.length&&!this._actionHandler&&!this._findCommand("help");return this._addImplicitHelpCommand}hook($,z){let G=["preSubcommand","preAction","postAction"];if(!G.includes($))throw new Error(`Unexpected value for event passed to hook : '${$}'.
Expecting one of '${G.join("', '")}'`);if(this._lifeCycleHooks[$])this._lifeCycleHooks[$].push(z);else this._lifeCycleHooks[$]=[z];return this}exitOverride($){if($)this._exitCallback=$;else this._exitCallback=(z)=>{if(z.code!=="commander.executeSubCommandAsync")throw z};return this}_exit($,z,G){if(this._exitCallback)this._exitCallback(new k($,z,G));U.exit($)}action($){let z=(G)=>{let J=this._args.length,Q=G.slice(0,J);if(this._storeOptionsAsProperties)Q[J]=this;else Q[J]=this.opts();return Q.push(this),$.apply(this,Q)};return this._actionHandler=z,this}createOption($,z){return new l($,z)}addOption($){let z=$.name(),G=$.attributeName();if($.negate){let Q=$.long.replace(/^--no-/,"--");if(!this._findOption(Q))this.setOptionValueWithSource(G,$.defaultValue===void 0?!0:$.defaultValue,"default")}else if($.defaultValue!==void 0)this.setOptionValueWithSource(G,$.defaultValue,"default");this.options.push($);let J=(Q,X,Z)=>{if(Q==null&&$.presetArg!==void 0)Q=$.presetArg;let Y=this.getOptionValue(G);if(Q!==null&&$.parseArg)try{Q=$.parseArg(Q,Y)}catch(_){if(_.code==="commander.invalidArgument"){let q=`${X} ${_.message}`;this.error(q,{exitCode:_.exitCode,code:_.code})}throw _}else if(Q!==null&&$.variadic)Q=$._concatValue(Q,Y);if(Q==null)if($.negate)Q=!1;else if($.isBoolean()||$.optional)Q=!0;else Q="";this.setOptionValueWithSource(G,Q,Z)};if(this.on("option:"+z,(Q)=>{let X=`error: option '${$.flags}' argument '${Q}' is invalid.`;J(Q,X,"cli")}),$.envVar)this.on("optionEnv:"+z,(Q)=>{let X=`error: option '${$.flags}' value '${Q}' from env '${$.envVar}' is invalid.`;J(Q,X,"env")});return this}_optionEx($,z,G,J,Q){if(typeof z==="object"&&z instanceof l)throw new Error("To add an Option object use addOption() instead of option() or requiredOption()");let X=this.createOption(z,G);if(X.makeOptionMandatory(!!$.mandatory),typeof J==="function")X.default(Q).argParser(J);else if(J instanceof RegExp){let Z=J;J=(Y,_)=>{let q=Z.exec(Y);return q?q[0]:_},X.default(Q).argParser(J)}else X.default(J);return this.addOption(X)}option($,z,G,J){return this._optionEx({},$,z,G,J)}requiredOption($,z,G,J){return this._optionEx({mandatory:!0},$,z,G,J)}combineFlagAndOptionalValue($=!0){return this._combineFlagAndOptionalValue=!!$,this}allowUnknownOption($=!0){return this._allowUnknownOption=!!$,this}allowExcessArguments($=!0){return this._allowExcessArguments=!!$,this}enablePositionalOptions($=!0){return this._enablePositionalOptions=!!$,this}passThroughOptions($=!0){if(this._passThroughOptions=!!$,!!this.parent&&$&&!this.parent._enablePositionalOptions)throw new Error("passThroughOptions can not be used without turning on enablePositionalOptions for parent command(s)");return this}storeOptionsAsProperties($=!0){if(this._storeOptionsAsProperties=!!$,this.options.length)throw new Error("call .storeOptionsAsProperties() before adding options");return this}getOptionValue($){if(this._storeOptionsAsProperties)return this[$];return this._optionValues[$]}setOptionValue($,z){return this.setOptionValueWithSource($,z,void 0)}setOptionValueWithSource($,z,G){if(this._storeOptionsAsProperties)this[$]=z;else this._optionValues[$]=z;return this._optionValueSources[$]=G,this}getOptionValueSource($){return this._optionValueSources[$]}getOptionValueSourceWithGlobals($){let z;return E(this).forEach((G)=>{if(G.getOptionValueSource($)!==void 0)z=G.getOptionValueSource($)}),z}_prepareUserArgs($,z){if($!==void 0&&!Array.isArray($))throw new Error("first parameter to parse must be array or undefined");if(z=z||{},$===void 0){if($=U.argv,U.versions&&U.versions.electron)z.from="electron"}this.rawArgs=$.slice();let G;switch(z.from){case void 0:case"node":this._scriptPath=$[1],G=$.slice(2);break;case"electron":if(U.defaultApp)this._scriptPath=$[1],G=$.slice(2);else G=$.slice(1);break;case"user":G=$.slice(0);break;default:throw new Error(`unexpected parse option { from: '${z.from}' }`)}if(!this._name&&this._scriptPath)this.nameFromFilename(this._scriptPath);return this._name=this._name||"program",G}parse($,z){let G=this._prepareUserArgs($,z);return this._parseCommand([],G),this}async parseAsync($,z){let G=this._prepareUserArgs($,z);return await this._parseCommand([],G),this}_executeSubCommand($,z){z=z.slice();let G=!1,J=[".js",".ts",".tsx",".mjs",".cjs"];function Q(q,B){let T=H.resolve(q,B);if(y.existsSync(T))return T;if(J.includes(H.extname(B)))return;let P=J.find((W)=>y.existsSync(`${T}${W}`));if(P)return`${T}${P}`;return}this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let X=$._executableFile||`${this._name}-${$._name}`,Z=this._executableDir||"";if(this._scriptPath){let q;try{q=y.realpathSync(this._scriptPath)}catch(B){q=this._scriptPath}Z=H.resolve(H.dirname(q),Z)}if(Z){let q=Q(Z,X);if(!q&&!$._executableFile&&this._scriptPath){let B=H.basename(this._scriptPath,H.extname(this._scriptPath));if(B!==this._name)q=Q(Z,`${B}-${$._name}`)}X=q||X}G=J.includes(H.extname(X));let Y;if(U.platform!=="win32")if(G)z.unshift(X),z=d(U.execArgv).concat(z),Y=A.spawn(U.argv[0],z,{stdio:"inherit"});else Y=A.spawn(X,z,{stdio:"inherit"});else z.unshift(X),z=d(U.execArgv).concat(z),Y=A.spawn(U.execPath,z,{stdio:"inherit"});if(!Y.killed)["SIGUSR1","SIGUSR2","SIGTERM","SIGINT","SIGHUP"].forEach((B)=>{U.on(B,()=>{if(Y.killed===!1&&Y.exitCode===null)Y.kill(B)})});let _=this._exitCallback;if(!_)Y.on("close",U.exit.bind(U));else Y.on("close",()=>{_(new k(U.exitCode||0,"commander.executeSubCommandAsync","(close)"))});Y.on("error",(q)=>{if(q.code==="ENOENT"){let B=Z?`searched for local subcommand relative to directory '${Z}'`:"no directory for search for local subcommand, use .executableDir() to supply a custom directory",T=`'${X}' does not exist
 - if '${$._name}' is not meant to be an executable command, remove description parameter from '.command()' and use '.description()' instead
 - if the default executable name is not suitable, use the executableFile option to supply a custom name or path
 - ${B}`;throw new Error(T)}else if(q.code==="EACCES")throw new Error(`'${X}' not executable`);if(!_)U.exit(1);else{let B=new k(1,"commander.executeSubCommandAsync","(error)");B.nestedError=q,_(B)}}),this.runningCommand=Y}_dispatchSubcommand($,z,G){let J=this._findCommand($);if(!J)this.help({error:!0});let Q;return Q=this._chainOrCallSubCommandHook(Q,J,"preSubcommand"),Q=this._chainOrCall(Q,()=>{if(J._executableHandler)this._executeSubCommand(J,z.concat(G));else return J._parseCommand(z,G)}),Q}_checkNumberOfArguments(){if(this._args.forEach(($,z)=>{if($.required&&this.args[z]==null)this.missingArgument($.name())}),this._args.length>0&&this._args[this._args.length-1].variadic)return;if(this.args.length>this._args.length)this._excessArguments(this.args)}_processArguments(){let $=(G,J,Q)=>{let X=J;if(J!==null&&G.parseArg)try{X=G.parseArg(J,Q)}catch(Z){if(Z.code==="commander.invalidArgument"){let Y=`error: command-argument value '${J}' is invalid for argument '${G.name()}'. ${Z.message}`;this.error(Y,{exitCode:Z.exitCode,code:Z.code})}throw Z}return X};this._checkNumberOfArguments();let z=[];this._args.forEach((G,J)=>{let Q=G.defaultValue;if(G.variadic){if(J<this.args.length){if(Q=this.args.slice(J),G.parseArg)Q=Q.reduce((X,Z)=>{return $(G,Z,X)},G.defaultValue)}else if(Q===void 0)Q=[]}else if(J<this.args.length){if(Q=this.args[J],G.parseArg)Q=$(G,Q,G.defaultValue)}z[J]=Q}),this.processedArgs=z}_chainOrCall($,z){if($&&$.then&&typeof $.then==="function")return $.then(()=>z());return z()}_chainOrCallHooks($,z){let G=$,J=[];if(E(this).reverse().filter((Q)=>Q._lifeCycleHooks[z]!==void 0).forEach((Q)=>{Q._lifeCycleHooks[z].forEach((X)=>{J.push({hookedCommand:Q,callback:X})})}),z==="postAction")J.reverse();return J.forEach((Q)=>{G=this._chainOrCall(G,()=>{return Q.callback(Q.hookedCommand,this)})}),G}_chainOrCallSubCommandHook($,z,G){let J=$;if(this._lifeCycleHooks[G]!==void 0)this._lifeCycleHooks[G].forEach((Q)=>{J=this._chainOrCall(J,()=>{return Q(this,z)})});return J}_parseCommand($,z){let G=this.parseOptions(z);if(this._parseOptionsEnv(),this._parseOptionsImplied(),$=$.concat(G.operands),z=G.unknown,this.args=$.concat(z),$&&this._findCommand($[0]))return this._dispatchSubcommand($[0],$.slice(1),z);if(this._hasImplicitHelpCommand()&&$[0]===this._helpCommandName){if($.length===1)this.help();return this._dispatchSubcommand($[1],[],[this._helpLongFlag])}if(this._defaultCommandName)return p(this,z),this._dispatchSubcommand(this._defaultCommandName,$,z);if(this.commands.length&&this.args.length===0&&!this._actionHandler&&!this._defaultCommandName)this.help({error:!0});p(this,G.unknown),this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let J=()=>{if(G.unknown.length>0)this.unknownOption(G.unknown[0])},Q=`command:${this.name()}`;if(this._actionHandler){J(),this._processArguments();let X;if(X=this._chainOrCallHooks(X,"preAction"),X=this._chainOrCall(X,()=>this._actionHandler(this.processedArgs)),this.parent)X=this._chainOrCall(X,()=>{this.parent.emit(Q,$,z)});return X=this._chainOrCallHooks(X,"postAction"),X}if(this.parent&&this.parent.listenerCount(Q))J(),this._processArguments(),this.parent.emit(Q,$,z);else if($.length){if(this._findCommand("*"))return this._dispatchSubcommand("*",$,z);if(this.listenerCount("command:*"))this.emit("command:*",$,z);else if(this.commands.length)this.unknownCommand();else J(),this._processArguments()}else if(this.commands.length)J(),this.help({error:!0});else J(),this._processArguments()}_findCommand($){if(!$)return;return this.commands.find((z)=>z._name===$||z._aliases.includes($))}_findOption($){return this.options.find((z)=>z.is($))}_checkForMissingMandatoryOptions(){for(let $=this;$;$=$.parent)$.options.forEach((z)=>{if(z.mandatory&&$.getOptionValue(z.attributeName())===void 0)$.missingMandatoryOptionValue(z)})}_checkForConflictingLocalOptions(){let $=this.options.filter((G)=>{let J=G.attributeName();if(this.getOptionValue(J)===void 0)return!1;return this.getOptionValueSource(J)!=="default"});$.filter((G)=>G.conflictsWith.length>0).forEach((G)=>{let J=$.find((Q)=>G.conflictsWith.includes(Q.attributeName()));if(J)this._conflictingOption(G,J)})}_checkForConflictingOptions(){for(let $=this;$;$=$.parent)$._checkForConflictingLocalOptions()}parseOptions($){let z=[],G=[],J=z,Q=$.slice();function X(Y){return Y.length>1&&Y[0]==="-"}let Z=null;while(Q.length){let Y=Q.shift();if(Y==="--"){if(J===G)J.push(Y);J.push(...Q);break}if(Z&&!X(Y)){this.emit(`option:${Z.name()}`,Y);continue}if(Z=null,X(Y)){let _=this._findOption(Y);if(_){if(_.required){let q=Q.shift();if(q===void 0)this.optionMissingArgument(_);this.emit(`option:${_.name()}`,q)}else if(_.optional){let q=null;if(Q.length>0&&!X(Q[0]))q=Q.shift();this.emit(`option:${_.name()}`,q)}else this.emit(`option:${_.name()}`);Z=_.variadic?_:null;continue}}if(Y.length>2&&Y[0]==="-"&&Y[1]!=="-"){let _=this._findOption(`-${Y[1]}`);if(_){if(_.required||_.optional&&this._combineFlagAndOptionalValue)this.emit(`option:${_.name()}`,Y.slice(2));else this.emit(`option:${_.name()}`),Q.unshift(`-${Y.slice(2)}`);continue}}if(/^--[^=]+=/.test(Y)){let _=Y.indexOf("="),q=this._findOption(Y.slice(0,_));if(q&&(q.required||q.optional)){this.emit(`option:${q.name()}`,Y.slice(_+1));continue}}if(X(Y))J=G;if((this._enablePositionalOptions||this._passThroughOptions)&&z.length===0&&G.length===0){if(this._findCommand(Y)){if(z.push(Y),Q.length>0)G.push(...Q);break}else if(Y===this._helpCommandName&&this._hasImplicitHelpCommand()){if(z.push(Y),Q.length>0)z.push(...Q);break}else if(this._defaultCommandName){if(G.push(Y),Q.length>0)G.push(...Q);break}}if(this._passThroughOptions){if(J.push(Y),Q.length>0)J.push(...Q);break}J.push(Y)}return{operands:z,unknown:G}}opts(){if(this._storeOptionsAsProperties){let $={},z=this.options.length;for(let G=0;G<z;G++){let J=this.options[G].attributeName();$[J]=J===this._versionOptionName?this._version:this[J]}return $}return this._optionValues}optsWithGlobals(){return E(this).reduce(($,z)=>Object.assign($,z.opts()),{})}error($,z){if(this._outputConfiguration.outputError(`${$}
`,this._outputConfiguration.writeErr),typeof this._showHelpAfterError==="string")this._outputConfiguration.writeErr(`${this._showHelpAfterError}
`);else if(this._showHelpAfterError)this._outputConfiguration.writeErr(`
`),this.outputHelp({error:!0});let G=z||{},J=G.exitCode||1,Q=G.code||"commander.error";this._exit(J,Q,$)}_parseOptionsEnv(){this.options.forEach(($)=>{if($.envVar&&$.envVar in U.env){let z=$.attributeName();if(this.getOptionValue(z)===void 0||["default","config","env"].includes(this.getOptionValueSource(z)))if($.required||$.optional)this.emit(`optionEnv:${$.name()}`,U.env[$.envVar]);else this.emit(`optionEnv:${$.name()}`)}})}_parseOptionsImplied(){let $=new k0(this.options),z=(G)=>{return this.getOptionValue(G)!==void 0&&!["default","implied"].includes(this.getOptionValueSource(G))};this.options.filter((G)=>G.implied!==void 0&&z(G.attributeName())&&$.valueFromOption(this.getOptionValue(G.attributeName()),G)).forEach((G)=>{Object.keys(G.implied).filter((J)=>!z(J)).forEach((J)=>{this.setOptionValueWithSource(J,G.implied[J],"implied")})})}missingArgument($){let z=`error: missing required argument '${$}'`;this.error(z,{code:"commander.missingArgument"})}optionMissingArgument($){let z=`error: option '${$.flags}' argument missing`;this.error(z,{code:"commander.optionMissingArgument"})}missingMandatoryOptionValue($){let z=`error: required option '${$.flags}' not specified`;this.error(z,{code:"commander.missingMandatoryOptionValue"})}_conflictingOption($,z){let G=(X)=>{let Z=X.attributeName(),Y=this.getOptionValue(Z),_=this.options.find((B)=>B.negate&&Z===B.attributeName()),q=this.options.find((B)=>!B.negate&&Z===B.attributeName());if(_&&(_.presetArg===void 0&&Y===!1||_.presetArg!==void 0&&Y===_.presetArg))return _;return q||X},J=(X)=>{let Z=G(X),Y=Z.attributeName();if(this.getOptionValueSource(Y)==="env")return`environment variable '${Z.envVar}'`;return`option '${Z.flags}'`},Q=`error: ${J($)} cannot be used with ${J(z)}`;this.error(Q,{code:"commander.conflictingOption"})}unknownOption($){if(this._allowUnknownOption)return;let z="";if($.startsWith("--")&&this._showSuggestionAfterError){let J=[],Q=this;do{let X=Q.createHelp().visibleOptions(Q).filter((Z)=>Z.long).map((Z)=>Z.long);J=J.concat(X),Q=Q.parent}while(Q&&!Q._enablePositionalOptions);z=m($,J)}let G=`error: unknown option '${$}'${z}`;this.error(G,{code:"commander.unknownOption"})}_excessArguments($){if(this._allowExcessArguments)return;let z=this._args.length,G=z===1?"":"s",Q=`error: too many arguments${this.parent?` for '${this.name()}'`:""}. Expected ${z} argument${G} but got ${$.length}.`;this.error(Q,{code:"commander.excessArguments"})}unknownCommand(){let $=this.args[0],z="";if(this._showSuggestionAfterError){let J=[];this.createHelp().visibleCommands(this).forEach((Q)=>{if(J.push(Q.name()),Q.alias())J.push(Q.alias())}),z=m($,J)}let G=`error: unknown command '${$}'${z}`;this.error(G,{code:"commander.unknownCommand"})}version($,z,G){if($===void 0)return this._version;this._version=$,z=z||"-V, --version",G=G||"output the version number";let J=this.createOption(z,G);return this._versionOptionName=J.attributeName(),this.options.push(J),this.on("option:"+J.name(),()=>{this._outputConfiguration.writeOut(`${$}
`),this._exit(0,"commander.version",$)}),this}description($,z){if($===void 0&&z===void 0)return this._description;if(this._description=$,z)this._argsDescription=z;return this}summary($){if($===void 0)return this._summary;return this._summary=$,this}alias($){if($===void 0)return this._aliases[0];let z=this;if(this.commands.length!==0&&this.commands[this.commands.length-1]._executableHandler)z=this.commands[this.commands.length-1];if($===z._name)throw new Error("Command alias can't be the same as its name");return z._aliases.push($),this}aliases($){if($===void 0)return this._aliases;return $.forEach((z)=>this.alias(z)),this}usage($){if($===void 0){if(this._usage)return this._usage;let z=this._args.map((G)=>{return w0(G)});return[].concat(this.options.length||this._hasHelpOption?"[options]":[],this.commands.length?"[command]":[],this._args.length?z:[]).join(" ")}return this._usage=$,this}name($){if($===void 0)return this._name;return this._name=$,this}nameFromFilename($){return this._name=H.basename($,H.extname($)),this}executableDir($){if($===void 0)return this._executableDir;return this._executableDir=$,this}helpInformation($){let z=this.createHelp();if(z.helpWidth===void 0)z.helpWidth=$&&$.error?this._outputConfiguration.getErrHelpWidth():this._outputConfiguration.getOutHelpWidth();return z.formatHelp(this,z)}_getHelpContext($){$=$||{};let z={error:!!$.error},G;if(z.error)G=(J)=>this._outputConfiguration.writeErr(J);else G=(J)=>this._outputConfiguration.writeOut(J);return z.write=$.write||G,z.command=this,z}outputHelp($){let z;if(typeof $==="function")z=$,$=void 0;let G=this._getHelpContext($);E(this).reverse().forEach((Q)=>Q.emit("beforeAllHelp",G)),this.emit("beforeHelp",G);let J=this.helpInformation(G);if(z){if(J=z(J),typeof J!=="string"&&!Buffer.isBuffer(J))throw new Error("outputHelp callback must return a string or a Buffer")}G.write(J),this.emit(this._helpLongFlag),this.emit("afterHelp",G),E(this).forEach((Q)=>Q.emit("afterAllHelp",G))}helpOption($,z){if(typeof $==="boolean")return this._hasHelpOption=$,this;this._helpFlags=$||this._helpFlags,this._helpDescription=z||this._helpDescription;let G=y0(this._helpFlags);return this._helpShortFlag=G.shortFlag,this._helpLongFlag=G.longFlag,this}help($){this.outputHelp($);let z=U.exitCode||0;if(z===0&&$&&typeof $!=="function"&&$.error)z=1;this._exit(z,"commander.help","(outputHelp)")}addHelpText($,z){let G=["beforeAll","before","after","afterAll"];if(!G.includes($))throw new Error(`Unexpected value for position to addHelpText.
Expecting one of '${G.join("', '")}'`);let J=`${$}Help`;return this.on(J,(Q)=>{let X;if(typeof z==="function")X=z({error:Q.error,command:Q.command});else X=z;if(X)Q.write(`${X}
`)}),this}}function p($,z){if($._hasHelpOption&&z.find((J)=>J===$._helpLongFlag||J===$._helpShortFlag))$.outputHelp(),$._exit(0,"commander.helpDisplayed","(outputHelp)")}function d($){return $.map((z)=>{if(!z.startsWith("--inspect"))return z;let G,J="127.0.0.1",Q="9229",X;if((X=z.match(/^(--inspect(-brk)?)$/))!==null)G=X[1];else if((X=z.match(/^(--inspect(-brk|-port)?)=([^:]+)$/))!==null)if(G=X[1],/^\d+$/.test(X[3]))Q=X[3];else J=X[3];else if((X=z.match(/^(--inspect(-brk|-port)?)=([^:]+):(\d+)$/))!==null)G=X[1],J=X[3],Q=X[4];if(G&&Q!=="0")return`${G}=${J}:${parseInt(Q)+1}`;return z})}function E($){let z=[];for(let G=$;G;G=G.parent)z.push(G);return z}C0.Command=C});var a=S((L,t)=>{var{Argument:O0}=N(),{Command:s}=i(),{CommanderError:x0,InvalidArgumentError:r}=j(),{Help:f0}=M(),{Option:v0}=w();L=t.exports=new s;L.program=L;L.Argument=O0;L.Command=s;L.CommanderError=x0;L.Help=f0;L.InvalidArgumentError=r;L.InvalidOptionArgumentError=r;L.Option=v0});var n=J0(a(),1),{program:i0,createCommand:s0,createArgument:r0,createOption:t0,CommanderError:a0,InvalidArgumentError:n0,InvalidOptionArgumentError:o0,Command:o,Argument:e0,Option:$1,Help:z1}=n.default;class b{async getModIdFromHash($){let z=await fetch(`https://api.modrinth.com/v2/version_file/${$}`);if(!z.ok)return null;return(await z.json()).project_id||null}async getModReleases($){let z=await fetch(`https://api.modrinth.com/v2/project/${$}`);if(!z.ok)throw new Error("Mod not found on Modrinth");let G=await z.json(),J=await fetch(`https://api.modrinth.com/v2/project/${$}/version`);if(!J.ok)throw new Error("Could not fetch versions from Modrinth");let X=(await J.json()).map((Z)=>({mcVersions:Z.game_versions,modVersion:Z.version_number,repository:"modrinth",loaders:(Z.loaders||[]).map((Y)=>Y)}));return{name:G.title||G.slug||$,releases:X}}async searchMods($){let z=await fetch(`https://api.modrinth.com/v2/search?query=${encodeURIComponent($)}`);if(!z.ok)throw new Error("Failed to fetch search results from Modrinth");return(await z.json()).hits.map((J)=>({name:J.title,imageURL:J.icon_url||"",downloadCount:J.downloads||0}))}}class D{exactVersion=null;minimalVersion=null;loaders=[];unresolvedMods=[];cache=new Map;repositories=[new b];constructor(){}setExactVersion($){return this.exactVersion=$,this}chooseMinimalVersion($){return this.minimalVersion=$,this}setLoaders($){return this.loaders=[...$],this}addModFromHash($){return this.unresolvedMods.push({source:"hash",data:$}),this}addModFromID($){return this.unresolvedMods.push({source:"id",data:$}),this}async work($){let z=await this.resolveMods();return this.resolveSolutions(z,$)}resolveSolutions($,z){let J=this.getFlatReleases($).filter(([Z,Y])=>this.matchConstraints(Y)),Q=this.extractConfigCandidates(J);Q.sort((Z,Y)=>{return this.compareVersions(Y.mcVersion,Z.mcVersion)});let X=[];for(let Z of Q){if(X.length>=z)break;let Y=[],_=new Set;for(let[q,B]of J){if(_.has(q.name))continue;if(B.mcVersions.includes(Z.mcVersion)&&B.loaders.includes(Z.loader))Y.push({name:q.name,release:B}),_.add(q.name)}if(_.size===$.length)X.push({mcConfig:Z,mods:Y})}return X}async resolveMods(){let $=[];for(let z of this.unresolvedMods){let G=this.cache.get(z);if(!G)G=await this.resolveMod(z),this.cache.set(z,G);$.push(G)}return $}getFlatReleases($){return $.flatMap((z)=>z.releases.map((G)=>[{name:z.name},G]))}extractConfigCandidates($){let z=[],G=new Set;for(let[J,Q]of $)for(let X of Q.mcVersions)for(let Z of Q.loaders){let Y=`${X}:${Z}`;if(!G.has(Y))G.add(Y),z.push({mcVersion:X,loader:Z})}return z}matchConstraints($){if(this.loaders.length>0&&!this.loaders.some((z)=>$.loaders.includes(z)))return!1;if(this.exactVersion&&!$.mcVersions.includes(this.exactVersion))return!1;if(this.minimalVersion){if(!$.mcVersions.some((G)=>this.compareVersions(G,this.minimalVersion)>=0))return!1}return!0}compareVersions($,z){let G=$.split(".").map((Q)=>parseInt(Q)||0),J=z.split(".").map((Q)=>parseInt(Q)||0);for(let Q=0;Q<Math.max(G.length,J.length);Q++){let X=Q<G.length?G[Q]:0,Z=Q<J.length?J[Q]:0;if(X<Z)return-1;else if(X>Z)return 1}return 0}async resolveMod($){switch($.source){case"hash":for(let z of this.repositories){let G=await z.getModIdFromHash($.data);if(G)return await z.getModReleases(G)}throw new Error(`Mod with hash ${$.data} not found in any repository`);case"id":for(let z of this.repositories)try{return await z.getModReleases($.data)}catch{}throw new Error(`Mod with ID ${$.data} not found in any repository`)}}}var I=new o;I.name("modpack-cli").description("CLI for managing modpacks").version("0.0.1");I.command("create").description("Create a new modpack").argument("<name>","Name of the modpack").action(($)=>{new D().create($),console.log(`Modpack '${$}' created successfully.`)});I.command("list").description("List all modpacks").action(()=>{let z=new D().list();console.log("Available modpacks:",z)});I.parse(process.argv);
